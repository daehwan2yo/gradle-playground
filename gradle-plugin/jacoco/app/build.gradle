/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'gradle.jacoco.java-application-conventions'
    id 'jacoco'
}

dependencies {
    implementation 'org.apache.commons:commons-text'
    implementation project(':utilities')
}

application {
    // Define the main class for the application.
    mainClass = 'gradle.jacoco.app.App'
}

test {
  finalizedBy jacocoTestReport
}

jacoco {
  toolVersion = '0.8.7'
  reportsDirectory = layout.buildDirectory.dir('customJacocoReportDir')
}

jacocoTestReport {
  dependsOn test
  reports {
    html.required = true
    xml.required = false
    csv.required = false

    html.destination = file("$buildDir/jacocoHtml/jacoco.html")
  }
}

jacocoTestCoverageVerification {
  violationRules {
    rule {
      limit {
        minimum = 0.5
      }
    }

    rule {
      enabled = false
      element = 'CLASS'
      includes = ['org.gradle.*']

      limit {
        counter = 'LINE'
        value = 'TOTALCOUNT'
        maximum = 0.3
      }
    }
  }
}
